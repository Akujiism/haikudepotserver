<!--
This ant script is invoked from the 'compile' goal of the maven project.  From the internet, it will
pull down all of the web-resources (js, css etc...) that it needs to function.  This approach avoids
the need to incorporate these elements in the source distribution.  See the 'pom.xml' for the location
from where this is invoked.
-->

<project name="fetchwebresources" default="main" basedir=".">

    <target name="js">

        <mkdir dir="${js.libsroot}"/>

        <get src="${js.cdnurl}/angular-ui/${angularuiutils.version}/angular-ui-ieshiv.js" dest="${js.libsroot}/angular-ui-ieshiv.js" skipexisting="true" />
        <get src="${js.cdnurl}/angular-ui/${angularuiutils.version}/angular-ui-ieshiv.min.js" dest="${js.libsroot}/angular-ui-ieshiv-min.js" skipexisting="true" />
        <!--<get src="${js.cdnurl}/angular-ui/${angularuiutils.version}/angular-ui.css" dest="${js.libsroot}/angular-ui.css" skipexisting="true" />-->
        <get src="${js.cdnurl}/angular-ui/${angularuiutils.version}/angular-ui.js" dest="${js.libsroot}/angular-ui.js" skipexisting="true" />
        <!--<get src="${js.cdnurl}/angular-ui/${angularuiutils.version}/angular-ui.min.css" dest="${js.libsroot}/angular-ui-min.css" skipexisting="true" />-->
        <get src="${js.cdnurl}/angular-ui/${angularuiutils.version}/angular-ui.min.js" dest="${js.libsroot}/angular-ui-min.js" skipexisting="true" />

        <get src="${js.cdnurl}/Base64/${base64js.version}/base64.min.js" dest="${js.libsroot}/base64-min.js" skipexisting="true" />

        <!-- core extensions -->
        <get src="${js.cdnurl}/underscore.js/${underscorejs.version}/underscore.js" dest="${js.libsroot}/underscore.js" skipexisting="true" />
        <get src="${js.cdnurl}/underscore.js/${underscorejs.version}/underscore-min.js" dest="${js.libsroot}/underscore-min.js" skipexisting="true" />
        <get src="${js.cdnurl}/underscore.js/${underscorejs.version}/underscore-min.map" dest="${js.libsroot}/underscore-min.map" skipexisting="true" />

        <!-- date and time handling -->
        <get src="${js.cdnurl}/moment.js/${momentjs.version}/moment.js" dest="${js.libsroot}/moment.js" skipexisting="true" />
        <get src="${js.cdnurl}/moment.js/${momentjs.version}/moment.min.js" dest="${js.libsroot}/moment-min.js" skipexisting="true" />

    </target>

    <target name="angularjs.check">
        <available property="angularjs.present" file="${js.libsroot}/angular"/>
    </target>

    <target name="angularjs" depends="angularjs.check" unless="angularjs.present">
        <get src="${js.angularjsurl}/${angularjs.version}/angular-${angularjs.version}.zip" dest="${java.io.tmpdir}/angular.zip" />
        <unzip src="${java.io.tmpdir}/angular.zip" dest="${js.libsroot}">
            <patternset>
                <exclude name="angular-${angularjs.version}/docs"></exclude>
                <exclude name="angular-${angularjs.version}/docs/**"></exclude>
            </patternset>
            <globmapper from="angular-${angularjs.version}/*" to="angular/*"/>
        </unzip>
        <delete file="${java.io.tmpdir}/angular.zip"/>
    </target>

    <target name="main" depends="js,angularjs"/>

</project>